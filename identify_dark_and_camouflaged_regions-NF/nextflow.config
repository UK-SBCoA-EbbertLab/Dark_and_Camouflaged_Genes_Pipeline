// CONFIGURATION FILE

process {

    withLabel: "samtools_collate_and_fastq_proc" {
        executor='slurm'
		queue = 'normal'
		cpus = 4
		mem_string = '8'
		memory = "${mem_string}.GB"
        clusterOptions='--time 2:00:00 --account coa_mteb223_uksr'
    }

    withLabel: "split_fastq_proc" {
        executor='slurm'
		queue = 'normal'
		cpus = 1
		mem_string = '10'
		memory = "${mem_string}.GB"
        clusterOptions='--time 1:00:00 --account coa_mteb223_uksr'
    }

    withLabel: "bwa_mem_proc" {
        executor='slurm'
		queue = 'normal'
		cpus = 8
		mem_string = '12'
		memory = "${mem_string}.GB"
        clusterOptions='--time 2:00:00 --account coa_mteb223_uksr'
    }

    withLabel: "samtools_coordinate_sort_proc" {
        executor='slurm'
		queue = 'normal'
		cpus = 4
		mem_string = '8'
		memory = "${mem_string}.GB"
        clusterOptions='--time 2:00:00 --account coa_mteb223_uksr'
    }

    withLabel: "samtools_merge_proc" {
        executor='slurm'
		queue = 'normal'
		cpus = 1
		mem_string = '4'
		memory = "${mem_string}.GB"
        clusterOptions='--time 2:00:00 --account coa_mteb223_uksr'
    }

    withLabel: "REALIGN_SAMPLES" {
        executor='slurm'
		queue = 'normal'
		cpus = 16
		mem_string = '200'
		memory = "${mem_string}.GB"
        clusterOptions='--time 24:00:00 --account coa_mteb223_uksr'
    }

	withLabel: "GENERATE_FASTQS_PROC" {
	    executor='slurm'
		queue = 'normal'
		cpus = 16
		mem_string = '100'
		memory = "${mem_string}.GB"
        clusterOptions='--time 5:00:00 --account coa_mteb223_uksr'
	
	}

	withLabel: "ALIGN_FASTQ_BWA_PROC" {
	    executor='slurm'
		queue = 'normal'
		cpus = 5
		mem_string = '30'
		memory = "${mem_string}.GB"
        clusterOptions='--time 5:00:00 --account coa_mteb223_uksr'
	
	}

	withLabel: "SORT_AND_INDEX_SAMPLE_PROC" {
	    executor='slurm'
		queue = 'normal'
		cpus = 5
		mem_string = '30'
		memory = "${mem_string}.GB"
        clusterOptions='--time 5:00:00 --account coa_mteb223_uksr'
	
	}


    withLabel: "RUN_DRF" {
        executor='slurm'
		queue = 'normal'
		cpus = 1
		mem_string = '20'
		memory = "${mem_string}.GB"
        clusterOptions='--time 24:00:00 --account coa_mteb223_uksr' 
    }

    withLabel: "COMBINE_DRF_OUTPUT" {
        executor='slurm'
		queue = 'normal'
		cpus = 16

		/*
		 * In this case, define mem per CPU since SLURM allows that.
		 */
        clusterOptions='--time 8:00:00 --account coa_mteb223_uksr --mem-per-cpu=2G'
    }

    withLabel: "CREATE_BED_FILE" {
		executor='slurm'
		queue = 'normal'
		cpus = 16

		/*
		 * In this case, define mem per CPU since SLURM allows that.
		 */
		clusterOptions='--time 48:00:00 --account coa_mteb223_uksr --mem-per-cpu=6G'
    }

    withLabel: "MASK_GENOME" {
		executor='slurm'
		queue = 'normal'
		cpus = 1

		mem_string = '10'
		memory = "${mem_string}.GB"

		clusterOptions='--time 6:00:00 --account coa_mteb223_uksr'
    }


    withLabel: local {
        executor='local'
    }

}



// Define executor type and maximum queue size for jobs at once ##

executor {

    name="slurm"
    queueSize = 50
}


// Point to singularity image with the tools necessary to run the pipeline
singularity {

    enabled = true
    process.container = "${projectDir}/../singularity/rescue_camo_variants.sif"
}

